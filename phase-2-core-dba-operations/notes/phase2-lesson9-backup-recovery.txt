Lesson9: Backup and recovery
---------------------------
 Backup   - copy of data taken at a point in time
 recovery - the process of bringing database back to a consistent state
 
==================== 
1. types of failures
====================

 1. Instance failure:
 ----------------
  . database crashes
  . power failuer
  . shutdown abort
  
  what is affected
  ----------------
   . memory ( SGA/PGA)
   
  what is not affected
  --------------------
   . datafiles
   . redo logs
   
  * recovery type : Instance recovery
    done by smon automatically
	
 2. Media failure
 ----------------
  . datafile deleted
  . disk failure
  . corruption
  
  * recovery type : media recovery
    needs backup + redo
	
====================	
2. instance recovery
====================
 when DB restrts
  . smon reads redo logs
  . applies committed changes
  . rolls back uncommitted work using undo
  
 * no DBA action required
   commit = redo written
   
==================   
3. media recovery
==================
 media recovery requires
  . backup of datafiles
  . redo logs ( online + archive)
  . oracle applies redo to backup
  
 * this is where archivelog mode matters
 
================================ 
4. archive log vs non-arvhive log
=================================

non-arvhive log
---------------
 . redo logs overwritten
 . recovery only till last backup
 . data loss possible
 
archivelog
----------
. redo logs archived
. point-in-time recovery possible
. mandatory for production

==============
5. hot vs cold
==============

cold backup:
----------
. database shut down
. files copied
. simple, consistent

hot backup:
----------
. database open
. requires archivelog
. no downtime

* modern oracle = hot backups with RMAN 

=======
6. RMAN
=======
. oracle's backup and recovery tool
. knows database structure
. validates backups
. applies redo automatically

=============================
7. what redo does in recovery
=============================
redo:
----
 . replays changes
 . brings datafiles forward in time
 
Undo:
----
 . rolls back incomplete work
 
checkpoint:
-----------
 . reduces recovery time
 
Redo  → replay changes
Undo  → roll back incomplete work
Checkpoint → reduce recovery time

